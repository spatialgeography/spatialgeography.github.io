<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.26">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Jadey Ryan">
<meta name="dcterms.date" content="2024-01-22">
<meta name="description" content="Unpolished notes and reflections from having a package reviewed in a livestream.">

<title>data whiskeRs | Notes from live code review of {soils} ‚Äì Spatial Geography</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../assets/img/spatial_logo.png" rel="icon" type="image/png">
<script src="../../site_libs/cookie-consent/cookie-consent.js"></script>
<link href="../../site_libs/cookie-consent/cookie-consent.css" rel="stylesheet">
<script src="../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-d640c705e8c17715bca3574aa719063f.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-dd0c9f5d1f9cb5c05a5e3a45b0d97b15.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script src="../../site_libs/quarto-contrib/iconify-1.0.8/iconify-icon.min.js"></script>
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-LEVV3VZT0E"></script>

<script type="text/plain" cookie-consent="tracking">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-LEVV3VZT0E', { 'anonymize_ip': true});
</script>

<script type="text/javascript" charset="UTF-8">
document.addEventListener('DOMContentLoaded', function () {
cookieconsent.run({
  "notice_banner_type":"simple",
  "consent_type":"express",
  "palette":"light",
  "language":"en",
  "page_load_consent_levels":["strictly-necessary"],
  "notice_banner_reject_button_hide":false,
  "preferences_center_close_button_hide":false,
  "website_name":""
  ,
"language":"en"
  });
});
</script> 
  
<style>html{ scroll-behavior: smooth; }</style>


<meta property="og:title" content="data whiskeRs | Notes from live code review of {soils}">
<meta property="og:description" content="Unpolished notes and reflections from having a package reviewed in a livestream.">
<meta property="og:image" content="https://jadeyryan.com/blog/2024-01-22_package-review/featured.webp">
<meta property="og:site_name" content="Spatial Geography">
<meta property="og:locale" content="en_EN">
<meta property="og:image:alt" content="My three cats laying in bed with the {soils} R package hex sticker placed in the middle.">
<meta name="twitter:title" content="data whiskeRs | Notes from live code review of {soils}">
<meta name="twitter:description" content="Unpolished notes and reflections from having a package reviewed in a livestream.">
<meta name="twitter:image" content="https://jadeyryan.com/blog/2024-01-22_package-review/featured.webp">
<meta name="twitter:creator" content="@jadeynryan">
<meta name="twitter:image:alt" content="My three cats laying in bed with the {soils} R package hex sticker placed in the middle.">
<meta name="twitter:card" content="summary_large_image">
</head>

<body class="nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../../assets/img/spatial_logo.png" alt="Spatial Geography Logo" class="navbar-logo light-content">
    <img src="../../assets/img/spatial_logo.png" alt="Spatial Geography Logo" class="navbar-logo dark-content">
    </a>
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Spatial Geography</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html"> 
<span class="menu-text">HOME</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">ABOUT</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../courses.html"> 
<span class="menu-text">COURSES</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../blog.html"> 
<span class="menu-text">ARTICLES</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../academy.html"> 
<span class="menu-text">ACADEMY</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../upcoming_classes.html"> 
<span class="menu-text">UPCOMING CLASSES</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-more" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">MORE</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-more">    
        <li>
    <a class="dropdown-item" href="../../projects.html">
 <span class="dropdown-text">Projects</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../talks.html">
 <span class="dropdown-text">Talks</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../cv.html">
 <span class="dropdown-text">CV</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="../../contact.html"> 
<span class="menu-text">CONTACT US</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="../../blog.xml"> <i class="bi bi-rss" role="img" aria-label="rss">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/jadeynryan"> <i class="bi bi-github" role="img" aria-label="GitHub">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/in/jadey-ryan/"> <i class="bi bi-linkedin" role="img" aria-label="LinkedIn">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://bsky.app/profile/jadeynryan.bsky.social"> 
<span class="menu-text"><iconify-icon inline="" icon="simple-icons:bluesky"></iconify-icon></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://fosstodon.org/@jadeynryan" rel="me"> <i class="bi bi-mastodon" role="img" aria-label="Mastodon">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://ko-fi.com/jadeyryan"> 
<span class="menu-text"><iconify-icon inline="" icon="simple-icons:kofi" style="font-size: 1.15em;" support="" me=""></iconify-icon></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#recording-of-live-code-review-session" id="toc-recording-of-live-code-review-session" class="nav-link active" data-scroll-target="#recording-of-live-code-review-session">Recording of live code review session</a></li>
  <li><a href="#new-tips-and-tricks-i-learned" id="toc-new-tips-and-tricks-i-learned" class="nav-link" data-scroll-target="#new-tips-and-tricks-i-learned">New tips and tricks I learned</a></li>
  <li><a href="#things-i-did-well" id="toc-things-i-did-well" class="nav-link" data-scroll-target="#things-i-did-well">Things I did well</a></li>
  <li><a href="#things-to-improve" id="toc-things-to-improve" class="nav-link" data-scroll-target="#things-to-improve">Things to improve</a></li>
  <li><a href="#notes" id="toc-notes" class="nav-link" data-scroll-target="#notes">Notes</a>
  <ul>
  <li><a href="#look-at-the-github-repo." id="toc-look-at-the-github-repo." class="nav-link" data-scroll-target="#look-at-the-github-repo.">Look at the GitHub repo.</a></li>
  <li><a href="#fork-the-package-and-copy-to-machine" id="toc-fork-the-package-and-copy-to-machine" class="nav-link" data-scroll-target="#fork-the-package-and-copy-to-machine">Fork the package and copy to machine</a></li>
  <li><a href="#run-goodpracticegp" id="toc-run-goodpracticegp" class="nav-link" data-scroll-target="#run-goodpracticegp">Run <code>goodpractice::gp()</code></a></li>
  <li><a href="#look-through-.r-files" id="toc-look-through-.r-files" class="nav-link" data-scroll-target="#look-through-.r-files">Look through <code>.R</code> files</a>
  <ul class="collapse">
  <li><a href="#create_soils.r" id="toc-create_soils.r" class="nav-link" data-scroll-target="#create_soils.r"><code>create_soils.R</code></a></li>
  <li><a href="#data.r" id="toc-data.r" class="nav-link" data-scroll-target="#data.r"><code>data.R</code></a></li>
  <li><a href="#data-rawexample_data.r" id="toc-data-rawexample_data.r" class="nav-link" data-scroll-target="#data-rawexample_data.r"><code>data-raw/example_data.R</code></a></li>
  <li><a href="#globals.r" id="toc-globals.r" class="nav-link" data-scroll-target="#globals.r"><code>globals.R</code></a></li>
  <li><a href="#helpers.r" id="toc-helpers.r" class="nav-link" data-scroll-target="#helpers.r"><code>helpers.R</code></a></li>
  <li><a href="#plots.r" id="toc-plots.r" class="nav-link" data-scroll-target="#plots.r"><code>plots.R</code></a></li>
  </ul></li>
  <li><a href="#vignettes" id="toc-vignettes" class="nav-link" data-scroll-target="#vignettes">Vignettes</a></li>
  <li><a href="#build-pkg-and-create-soils-project" id="toc-build-pkg-and-create-soils-project" class="nav-link" data-scroll-target="#build-pkg-and-create-soils-project">Build pkg and create soils project</a></li>
  <li><a href="#testing" id="toc-testing" class="nav-link" data-scroll-target="#testing">Testing</a></li>
  <li><a href="#commit-push-pr" id="toc-commit-push-pr" class="nav-link" data-scroll-target="#commit-push-pr">Commit, push, PR</a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/jadeynryan/jadey_website/blob/main/blog/2024-01-22_package-review/index.qmd" class="toc-action"><i class="bi bi-github"></i>View source</a></li><li><a href="https://github.com/jadeynryan/jadey_website/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Notes from live code review of {soils}</h1>
  <div class="quarto-categories">
    <div class="quarto-category">R</div>
    <div class="quarto-category">Quarto</div>
    <div class="quarto-category">Package dev</div>
    <div class="quarto-category">Code review</div>
    <div class="quarto-category">Reflection</div>
  </div>
  </div>

<div>
  <div class="description">
    Unpolished notes and reflections from having a package reviewed in a livestream.
  </div>
</div>


<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Jadey Ryan </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">January 22, 2024</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<p>First off, I want to say that I‚Äôm strongly resisting my perfectionism and time-blocked this blog post to about one hour! This is a very vulnerable and unpolished post, so please be gentle. üòå</p>
<p>A couple days ago, three ‚ú®<strong>expert</strong>‚ú® R package developers and reviewers looked at my package:</p>
<ul>
<li><a href="https://fosstodon.org/@njtierney@aus.social">Nicholas Tierney</a></li>
<li><a href="https://fosstodon.org/@milesmcbain">Miles McBain</a></li>
<li><a href="https://rstats.me/@adamhsparks">Adam Sparks</a></li>
</ul>
<p>The idea to livestream a R package review came from <a href="https://njtierney.com/"><strong>Nick Tierney</strong></a>. Others favorited, boosted, and commented on the <a href="https://aus.social/@njtierney/111780641044951873">Mastodon post</a>, including myself. I‚Äôve been working on this <a href="https://github.com/WA-Department-of-Agriculture/soils">{soils} R package</a> and am in the review/revise period of package development. Before I could get second thoughts, I volunteered this package for review. I was quite nervous about putting my work out there for critique, but I‚Äôm so happy that I did. And so grateful that Nick, Miles, and Adam all shared their brilliance! üß†üòá</p>
<p>I‚Äôve re-watched the session a few times to soak up all the gold nuggets of good practices, tips and tricks, and overall understanding of the package review process. Below, I‚Äôve included the recording of the session, bullet point summaries of what I learned, what I did well, and what I can improve, and then my unpolished and mostly disorganized notes.</p>
<p>If you just want to see what changes Nick suggested, see his <a href="https://github.com/WA-Department-of-Agriculture/soils/pull/3">pull request with suggestions/changes</a>.</p>
<p>Please comment and let me know if you learned something new, or if you see something else I can improve in my package development journey!</p>
<section id="recording-of-live-code-review-session" class="level2">
<h2 class="anchored" data-anchor-id="recording-of-live-code-review-session">Recording of live code review session</h2>
<div class="quarto-video ratio ratio-16x9"><iframe data-external="1" src="https://www.youtube.com/embed/OttYnXwM4dU" title="" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe></div>
</section>
<section id="new-tips-and-tricks-i-learned" class="level2">
<h2 class="anchored" data-anchor-id="new-tips-and-tricks-i-learned">New tips and tricks I learned</h2>
<ul>
<li><p>Use <a href="https://github.com/MangoTheCat/goodpractice"><code>goodpractice::gp()</code></a> to run a check for many good practices in R package development.</p></li>
<li><p>{cli} has special <a href="https://cli.r-lib.org/reference/inline-markup.html">inline markup classes</a>.</p></li>
<li><p><code>//</code> to add a new line in {cli} message. I bet this works with other long string arguments as well.</p></li>
<li><p><a href="https://usethis.r-lib.org/reference/use_package_doc.html"><code>usethis::use_package_doc()</code></a> generates basic package-level documentation.</p></li>
<li><p>Menu to open file or function: <code>Ctrl</code> + <code>.</code></p></li>
</ul>
</section>
<section id="things-i-did-well" class="level2">
<h2 class="anchored" data-anchor-id="things-i-did-well">Things I did well</h2>
<ul>
<li><p>Time and effort to make the user experience (UX) good: video demos, boxes and annotations for videos and screenshots, {pkgdown} website with detailed articles</p></li>
<li><p>Defensive programming: failing early and giving error messages</p></li>
<li><p>Using functions like <code>cat_red_bullet</code> and <code>cet_green_check</code> to set nice, informative {cli} message symbols</p></li>
<li><p>Consistent styling with <a href="https://github.com/gadenbuie/grkstyle">{grkstyle}</a></p></li>
<li><p>Including a URL reference to the exact commit of functions adapted from other packages</p></li>
<li><p>Including data dictionary was nice.</p></li>
<li><p>Generating example data from an R script to make it possible to reproduce.</p></li>
</ul>
</section>
<section id="things-to-improve" class="level2">
<h2 class="anchored" data-anchor-id="things-to-improve">Things to improve</h2>
<ul>
<li><p>Huge package size (not a big deal since using R-Universe instead of CRAN)</p></li>
<li><p>Incorporate testing</p></li>
<li><p>Error messages: take advantage of {cli} <a href="https://cli.r-lib.org/reference/inline-markup.html">inline markup</a>, provide an example of what the code <em>should</em> look like, tell the user if they need to provide something rather than say something is missing</p></li>
<li><p>Better use explaining variables in conditional statements to unravel confusing ifelse logic.</p></li>
<li><p>More consistency with approaches / utilities: base R or tidyverse</p></li>
<li><p>Naming things is so hard! Mixing snake_case and camelCase in the example data and data dictionary.</p>
<ul>
<li>Things to look into: <a href="https://fediscience.org/@bbolker/111791764707599216">comments responding to Ben Bolker‚Äôs Mastodon post</a>, <a href="https://www.pipinghotdata.com/posts/2022-09-13-the-case-for-variable-labels-in-r/">Shannon Pileggi‚Äôs post</a>, <a href="https://emilyriederer.netlify.app/post/column-name-contracts/">Emily Riederer‚Äôs post</a>, <a href="https://rdatatable.gitlab.io/data.table/reference/setattr.html"><code>data.table::setattr()</code></a>, and <a href="https://r-quantities.github.io/units/">{units}</a> thanks to <a href="https://fosstodon.org/@mccarthymg/111792645556619721">Michael McCarthy</a>.</li>
</ul></li>
<li><p>Be more descriptive with example data: call it <code>washi_example</code> instead of <code>exampleData</code> and include data viz.</p></li>
<li><p>Investigate <code>ggtern</code> overwriting <code>ggplot2</code> S3 methods warning more closely, resolve or rethrow more helpful warning text instead of using <code>suppressWarnings()</code>.</p></li>
<li><p>Write better commit messages following the template: ‚Äúthis commit will‚Ä¶‚Äù and use headlines and bullet points.</p></li>
</ul>
</section>
<section id="notes" class="level2">
<h2 class="anchored" data-anchor-id="notes">Notes</h2>
<p>There are lots of notes of things Nick would wanted to ‚Äúget to later‚Äù but we ran out of time. I left these notes in just to draw attention to other things we would have looked at more closely given more time.</p>
<section id="look-at-the-github-repo." class="level3">
<h3 class="anchored" data-anchor-id="look-at-the-github-repo.">Look at the GitHub repo.</h3>
<p><strong>About</strong>: provides context, a few features, and link to website.</p>
<p><strong>Website</strong>: video demos in README and main page of website</p>
<ul>
<li><p>Author cares about UX and make it easy to understand what the benefit of the package</p></li>
<li><p>Taking time to add boxes and annotations to videos and screenshots really helpful.</p></li>
<li><p>Empathy for R users who haven‚Äôt been using R for very long. Videos help take the user‚Äôs hand and walk them through it.</p></li>
</ul>
<p><strong>Articles</strong>: will get to later.</p>
<ul>
<li>Repo and website gives trust that the author wants the pkg to be easily usable and understandable.</li>
</ul>
</section>
<section id="fork-the-package-and-copy-to-machine" class="level3">
<h3 class="anchored" data-anchor-id="fork-the-package-and-copy-to-machine">Fork the package and copy to machine</h3>
<p>Used RStudio with New Project from Version Control.</p>
<p>Took a long time to clone. Not a big deal unless want the pkg on CRAN. Will get to later.</p>
<ul>
<li><p>Large R package. Likely from the example .docx and .html reports that are included.</p>
<ul>
<li>Look at README to see where video demos came from. Uses GitHub assets, so not included in pkg download. See how to do this in <a href="https://www.youtube.com/watch?v=G3Cytlicv8Y">GitHub‚Äôs video</a>.</li>
</ul></li>
</ul>
<p>Create new branch for changes/suggestions.</p>
</section>
<section id="run-goodpracticegp" class="level3">
<h3 class="anchored" data-anchor-id="run-goodpracticegp">Run <code>goodpractice::gp()</code></h3>
<p>Nick‚Äôs experience as <a href="https://ropensci.org/">ROpenSci</a> pkg reviewer to run this static analysis on the code. Makes markers for things that are easy to fix in the pkg.</p>
<p><a href="https://github.com/MangoTheCat/goodpractice">{goodpractice} repo</a></p>
<p>Run <code>devtools::install_dev_deps()</code> to install everything for the pkg.</p>
<p>Markers:</p>
<ul>
<li><p>Code lines that are &gt; 80 characters long.</p></li>
<li><p>No tests</p>
<ul>
<li><p>Tests are hard. Not sure how to do this with a project template based pkg. Will get back to this.</p></li>
<li><p><strong>Miles</strong>: ‚ÄúYeah so I think testing is hard here because the RStudioApi shows up pretty early in the workflow. To make things easier you could try to separate out as much possible work that can be done without it. then you contain the RStudioAPI stuff in a thin wrapper that wraps the functions that do the work. you can test the ‚Äòdo the work‚Äô functions. although it does appear the API is made optional!‚Äù</p></li>
<li><p><strong>Adam</strong>: ‚ÄúYou can use tempdir() as in your example for create_soils() and just check that the directories exists in tempdir() and are created as you expect.‚Äù</p></li>
<li><p><strong>Miles</strong>: ‚Äúyeah or maybe there‚Äôs a way to make the test for the RStudio API return false in non interactive mode. so put in &amp;&amp; interactive() there. then you can run your tests inside RStudio without hitting the API branch.‚Äù</p></li>
<li><p><strong>Adam</strong>: ‚ÄúI could see writing tests to circumvent the API would be useful, perhaps you could use it as a basis for automating a scripted setup that wasn‚Äôt interactive?‚Äù</p></li>
</ul></li>
<li><p>UTF-8 strings? not sure how to fix</p></li>
<li><p>Big installation size</p>
<ul>
<li><strong>Adam</strong>: ‚ÄúSize isn‚Äôt a big issue if you don‚Äôt plan to put it on CRAN‚Äù</li>
</ul></li>
<li><p>Not big deal breakers</p></li>
</ul>
</section>
<section id="look-through-.r-files" class="level3">
<h3 class="anchored" data-anchor-id="look-through-.r-files">Look through <code>.R</code> files</h3>
<section id="create_soils.r" class="level4">
<h4 class="anchored" data-anchor-id="create_soils.r"><code>create_soils.R</code></h4>
<ul>
<li><p><strong><code>roxygen</code> function documentation</strong></p>
<ul>
<li><code>@examples</code>: how would you use this? Create a soils project like a template R package in the given directory.</li>
</ul></li>
<li><p><strong>Function definition</strong></p>
<ul>
<li>Nice defensive programming with missing path giving error.</li>
</ul></li>
<li><p><strong>Error messages</strong></p>
<ul>
<li><p><strong>Improvement</strong>: use inline markup syntax in {cli} instead of back ticks for code. Instead of <code>"`path` is missing."</code>, use <code>"{.code path} is missing."</code></p></li>
<li><p>All classes are in <a href="https://cli.r-lib.org/reference/inline-markup.html"><code>inline-markup</code> of {cli}</a></p></li>
<li><p>Changed <code>"{.code path} is missing."</code> ‚Üí <code>"{.path path} is missing."</code></p></li>
<li><p>Keyboard shortcut <code>Ctrl</code>+<code>Shift</code>+<code>L</code> to call <code>devtools::load_all(".")</code>.</p>
<ul>
<li>Got message about <code>ggtern</code> overwriting <code>ggplot2</code> S3 methods. Come back to this later.</li>
</ul></li>
<li><p>Ran <code>create_soils()</code> with path missing to see error. This opened in Browser/debug mode.</p></li>
<li><p><strong>Improvement</strong>: add another info message with example:<br>
<code>"i" = "For example, {.code create_soils('path/to/my/directory')}"</code></p></li>
<li><p>Re-ran interactively to see updated error msg. Nice to not worry about including back ticks.</p></li>
<li><p><strong>Improvement</strong>: can render the actual path by wrapping it in another pair of curly braces like: <code>"{.path {path}} already exists."</code>.</p></li>
<li><p><strong>Improvement</strong>: add another info message with example and use <code>\\</code> to create a new line:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="st">"i"</span> <span class="ot">=</span> <span class="st">"To always overwrite: </span><span class="sc">\\</span><span class="st">  </span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="st">{.code create_soils({.path {path}} overwrite = TRUE)}"</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div></li>
<li><p>Liked <code>cat_red_bullet</code> a lot. Defined in <code>utils.R</code></p></li>
</ul></li>
<li><p><strong>Recommend interactive process</strong></p>
<ul>
<li>Tweak something, load the pkg (<code>load_all</code>), then play around in the console.</li>
</ul></li>
<li><p><strong>Logic of function</strong></p>
<ul>
<li><p><code>if (!isTRUE(overwrite))</code>:</p>
<ul>
<li>Could have used <code>if (isFALSE(overwrite))</code> but good practice to leave it as is since <code>overwrite</code> is user-defined</li>
</ul></li>
<li><p>Too much ifelse nesting. Referred to <a href="https://github.com/jennybc/code-smells-and-feels">Jenny Bryan‚Äôs Code Smells talk</a>.</p>
<ul>
<li><p><strong>Improvement</strong>: prioritize happy path. Failing early is good. Extract conditions into explaining variables (<code>dir_exists</code> and <code>overwriting</code>). Then use 3 if statements to emphasize each individual case:</p>
<ul>
<li><p><code>if (dir_exists &amp;&amp; !overwriting) {...}</code></p></li>
<li><p><code>if (dir_exists &amp;&amp; overwriting) {...}</code> good to inform user of overwriting existing project</p></li>
<li><p><code>if (!dir_exists) {...}</code></p></li>
</ul></li>
</ul></li>
<li><p>Would run {grkstyle} at this point after a chunk of refactoring if Nick had it installed.</p></li>
<li><p>Could consider wrapping each case into a function itself like <code>stop_if_dir_exists_and_overwriting(dir_exists, overwriting) {...}</code> to capture the intent. Reduces lines of code. Not a believer of just reducing lines of code. But is believer of writing functions to express yourself. Makes it eaier to browse through the code and maintain later. <a href="https://www.njtierney.com/post/2023/12/06/long-errors-smell/">Nick‚Äôs blog post of these thoughts</a>.</p></li>
<li><p><code>soils_sys()</code> in <code>utils.R</code>: really liked the fixed blob URL for the exact commit in {golem} for code reference.</p></li>
</ul></li>
<li><p><strong>Code style</strong></p>
<ul>
<li><p><strong>Miles</strong>: ‚ÄúThings are looking pretty clean. Did you use {styler} along the way?‚Äù.</p>
<ul>
<li>I used <a href="https://github.com/gadenbuie/grkstyle">{grkstyle}</a> from Garrick Aden-Buie.</li>
</ul></li>
<li><p><strong>Miles</strong>: ‚ÄúOne comment I would make having looked around a bit, which is visible here. There are some mixing of approaches / utilities. E.g. base::normalizePath shows up alongside fs:: stuff.‚Äù</p>
<ul>
<li><p><strong>Miles</strong>: ‚ÄúI think it‚Äôs safer to keep within one tool‚Äôs conception of how things are, otherwise subtle differences in underlying objects / assumptions can create edge cases where things break‚Äù</p></li>
<li><p><strong>Miles</strong>: ‚Äúfs::path_norm and fs::path_real are worth a look‚Äù</p></li>
<li><p>Looked at what <code>normalizePath()</code> does with <code>?normalizePath</code></p>
<ul>
<li>Was going to rewrite it, but doesn‚Äôt fully understand so will leave it.</li>
</ul></li>
</ul></li>
</ul></li>
</ul>
</section>
<section id="data.r" class="level4">
<h4 class="anchored" data-anchor-id="data.r"><code>data.R</code></h4>
<ul>
<li><p>Didn‚Äôt like mix of snake_case and camelCase. If this is a norm in the community, that‚Äôs okay.</p>
<ul>
<li><p><strong>Adam</strong>: ‚ÄúI picked this up too,the functions and some data are snake case but some data are camel case. I‚Äôd be consistent for myself and users. For better or worse, I tend to use‚Äù.‚Äù For separators with units in colnames.‚Äù</p></li>
<li><p><strong>Miles</strong>: ‚Äúput units in brackets so you regex them out? or maybe a better engineer would suggest storing them as attributes. Or you have vectors of objects with units if they‚Äôre really important to calculations. Oooh oooh {roxyglobals}‚Äù</p></li>
<li><p><strong>Adam</strong>: ‚ÄúMost times in my work the units aren‚Äôt important for calculations but for knowing how it was recorded‚Äù</p></li>
<li><p>Naming things and units are hard. I use camel case to delineate words and underscores to separate soil health measurement from the unit. The underscores make pivoting easier.</p></li>
</ul></li>
<li><p><strong>Improvement</strong>: instead of calling it <code>exampleData</code>, call it something more descriptive like <code>washi_example</code>.</p></li>
<li><p><strong>Improvement</strong>: add example table or data viz to show some of things I care about.</p></li>
<li><p>Data dictionary is really nice: shows what the columns are and what they mean.</p></li>
<li><p>Can quickly normalize names with <code>janitor::clean_names()</code>.</p></li>
</ul>
</section>
<section id="data-rawexample_data.r" class="level4">
<h4 class="anchored" data-anchor-id="data-rawexample_data.r"><code>data-raw/example_data.R</code></h4>
<ul>
<li>Great to have this included so it‚Äôs possible to reproduce the example data. Good signals that I care about this.</li>
</ul>
</section>
<section id="globals.r" class="level4">
<h4 class="anchored" data-anchor-id="globals.r"><code>globals.R</code></h4>
<ul>
<li><p>Avoids CRAN check issue.</p></li>
<li><p><strong>Improvement</strong>: <code>usethis::use_package_doc()</code> creates a <code>soils-package.R</code> file.</p>
<ul>
<li><p>Could move <code>utils::globalVariables()</code> into this file and remove <code>globals.R</code>. Having globals in own R file is fine. Actually kinda like it there.</p></li>
<li><p>Look at <a href="https://github.com/tidyverse/dplyr/blob/main/R/dplyr.R">dplyr</a> or <a href="https://github.com/njtierney/naniar/blob/master/R/naniar-package.R">narniar</a> for examples.</p></li>
<li><p>Include <code>if(getRversion() &gt;= "2.15.1")  utils::globalVariables(c("."))</code> in <code>soils-package.R</code> with globals. Not sure if this is needed?</p></li>
</ul></li>
</ul>
</section>
<section id="helpers.r" class="level4">
<h4 class="anchored" data-anchor-id="helpers.r"><code>helpers.R</code></h4>
<ul>
<li><p><code>calculate_mode()</code>: R doesn‚Äôt include mode function.</p>
<ul>
<li><strong>Adam</strong>: ‚ÄúOh! Watch the mode. I‚Äôll check your function in a bit, but I‚Äôve a function that allows you to handle multimodal distributions if you‚Äôd like. I got burned by my initial function to calculate mode. OK, you‚Äôve got the max. That‚Äôs good. I don‚Äôt recall what I did first off but I would get the max or min from a multimodal distribution, so I wrote this <a href="https://adamhsparks.codeberg.page/misc.debris/reference/mode.html">[function]</a> that handles multimodal distributions‚Äù</li>
</ul></li>
<li><p>Noticed use of base pipe.</p>
<ul>
<li><p>Updated DESCRIPTION to depend on R ‚â• 4.1.</p></li>
<li><p>Fancy triangle ligature from FiraCode-Light</p></li>
</ul></li>
<li><p>Running out of time so super quick review</p></li>
</ul>
</section>
<section id="plots.r" class="level4">
<h4 class="anchored" data-anchor-id="plots.r"><code>plots.R</code></h4>
<ul>
<li><p>Interested in the S3 methods overwritten by <code>ggtern</code> warning. Indicates something is going on but not sure what.</p></li>
<li><p>Optional: instead of namespacing <code>ggplot2::</code>, can add <code>#' @import ggplot2</code> to the <code>soils-package.R</code> which is kinda like running <code>library(ggplot2)</code>.</p></li>
<li><p>Really likes consistent styling. Makes code easy to read. Can turn off parts of brain to focus on various things.</p></li>
<li><p>Doesn‚Äôt have time to confidently to go through plotting code.</p></li>
<li><p><strong>Miles</strong>: ‚ÄúI‚Äôd like to hear Dr Nick‚Äôs opinion on plots.R line 22‚Äù</p>
<ul>
<li><p><code>suppressWarnings</code> wrapped around <code>make_texture_triangle</code> {ggplot2} code.</p></li>
<li><p>Not sure why suppressing warnings. Add comment at closing parentheses. No warnings when Nick ran the function example.</p></li>
<li><p><strong>Miles</strong>: ‚ÄúYou can even catch and rethrow with more relevant text if that would be helpful to people‚Äù</p></li>
</ul></li>
</ul>
</section>
</section>
<section id="vignettes" class="level3">
<h3 class="anchored" data-anchor-id="vignettes">Vignettes</h3>
<p>Look at <code>get-started.Rmd</code> to understand if it‚Äôs all point and click or if there‚Äôs code to run:</p>
<ul>
<li><p><strong>Installation</strong>: using r-universe (project by ROpenSci), like an alternative to CRAN. Shows author cares about user.</p></li>
<li><p>See Option 2: RStudio Console</p>
<ul>
<li><p>Project structure tree: great and takes time</p></li>
<li><p>From annotated screenshots, strong effort to make this easily usable</p></li>
</ul></li>
</ul>
<p>Back to R code: <code>create_soils()</code> in <code>create_soils.R</code></p>
</section>
<section id="build-pkg-and-create-soils-project" class="level3">
<h3 class="anchored" data-anchor-id="build-pkg-and-create-soils-project">Build pkg and create soils project</h3>
<p>Follow the point and click instructions for install {soils} with RStudio new project wizard.</p>
</section>
<section id="testing" class="level3">
<h3 class="anchored" data-anchor-id="testing">Testing</h3>
<p><code>usethis::use_testthat()</code></p>
<p><code>usethis::use_test("create-soils")</code> to create <code>test-create-soils.R</code> template to modify.</p>
<ul>
<li>Likes dashes over underscores for file names to make it easier to mouse across when holding <code>Alt</code> (<a href="https://www.youtube.com/live/OttYnXwM4dU?si=vA2_CjRtt5tNQBg5&amp;t=4026">1:07:06 timestamp for demoing this</a>). If using underscores, it jumps to the very end.</li>
</ul>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">test_that</span>(<span class="st">"create_soils returns appropriate error"</span>, {</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expect_snapshot_error</span>(</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">create_soils</span>()</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>})</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Running it once took a snapshot of the error message, which got saved in <code>tests/testthat/_snaps/create-soils.md</code>.</p>
<p>Running it again shows the test passed.</p>
<p>Changed <code>"`path` is missing."</code> ‚Üí <code>"{.path path} must be provided."</code>.</p>
<ul>
<li>Tells user you must provide the path. You need to do this thing.</li>
</ul>
<p>Run test again. It says the message has changed.</p>
<p>Click <code>testthat::snapshot_review('create-soils') to interactively review this change.</code></p>
<p>Shows the diff, which is what we want. Click <code>Accept</code>.</p>
<p>Good for snapshotting errors and outputs!</p>
</section>
<section id="commit-push-pr" class="level3">
<h3 class="anchored" data-anchor-id="commit-push-pr">Commit, push, PR</h3>
<p>Committed each individual change one at a time with descriptive commit messages.</p>
<p>Write commit messages following this template:</p>
<ul>
<li><p>[this commit will]‚Ä¶ * use tests and snapshot testing</p></li>
<li><p>[this commit will]‚Ä¶ * depend on R 4.1.0 since |&gt; is used</p></li>
</ul>
<p>Then add a summary headline:</p>
<ul>
<li>Tests, snapshots, base pipe:</li>
</ul>
<p>All together, the commit message:</p>
<pre><code>Tests, snapshots, base pipe:
* use tests and snapshot testing
* depend on R 4.1.0 since |&gt; is used</code></pre>
<p>Credit to Adam Brewer (spelling?) for this commit message template of ‚ÄúThis commit will‚Ä¶‚Äù to remember what he commit does.</p>
<p>Credit to Miles for idea of using the header and dot points.</p>
<p>Push then submit <a href="https://github.com/WA-Department-of-Agriculture/soils/pull/3">PR with suggestions/changes</a>!</p>


</section>
</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{ryan2024,
  author = {Ryan, Jadey},
  title = {Notes from Live Code Review of \{Soils\}},
  date = {2024-01-22},
  url = {https://jadeyryan.com/blog/2024-01-22_package-review/},
  langid = {en}
}
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-ryan2024" class="csl-entry quarto-appendix-citeas" role="listitem">
Ryan, Jadey. 2024. <span>‚ÄúNotes from Live Code Review of
{Soils}.‚Äù</span> January 22, 2024. <a href="https://jadeyryan.com/blog/2024-01-22_package-review/">https://jadeyryan.com/blog/2024-01-22_package-review/</a>.
</div></div></section></div></main> <!-- /main -->
<script type="text/javascript" src="https://storage.ko-fi.com/cdn/widget/Widget_2.js"></script><script type="text/javascript">kofiwidget2.init('Support me', '#0b7366', 'F1F3TKSJB');kofiwidget2.draw();</script>
<div class="subscribe">
    <h5> Subscribe to get notified about new content. </h5>

    <img id="subscribe-thumbnail" style="margin-bottom: 1em;border-radius: 10px;" width="70%" src="../../assets/img/data-whiskeRs-thumbnail.webp" alt="Thumbnail for the data whiskeRs blog. Dark teal color with white text reading data whiskeRs: R code &amp; data science content with a sprinkle of cute cats.">

    <iframe id="subscribe-iframe" src="https://embeds.beehiiv.com/8136e0e9-2605-4a26-9d6b-ec29a105193a?slim=true" data-test-id="beehiiv-embed" height="80" width="70%" frameborder="0" scrolling="no" style="margin: 0; border-radius: 0px !important; background-color: transparent;"></iframe>

</div>
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "Óßã";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/jadeyryan\.com");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
            // target, if specified
            link.setAttribute("target", "_blank");
            if (link.getAttribute("rel") === null) {
              link.setAttribute("rel", "noopener");
            }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<input type="hidden" id="giscus-base-theme" value="light">
<input type="hidden" id="giscus-alt-theme" value="light">
<script>
  function loadGiscus() {
    // Function to get the theme based on body class
    const getTheme = () => {
      let baseTheme = document.getElementById('giscus-base-theme').value;
      let altTheme = document.getElementById('giscus-alt-theme').value;
      return document.body.classList.contains('quarto-dark') ? altTheme : baseTheme;
    };
    const script = document.createElement("script");
    script.src = "https://giscus.app/client.js";
    script.async = true;
    script.dataset.repo = "jadeynryan/jadey-website-giscus";
    script.dataset.repoId = "R_kgDOKisUNQ";
    script.dataset.category = "Announcements";
    script.dataset.categoryId = "DIC_kwDOKisUNc4CaSRD";
    script.dataset.mapping = "pathname";
    script.dataset.reactionsEnabled = "1";
    script.dataset.emitMetadata = "0";
    script.dataset.inputPosition = "top";
    script.dataset.theme = getTheme();
    script.dataset.lang = "en";
    script.crossOrigin = "anonymous";
    // Append the script to the desired div instead of at the end of the body
    document.getElementById("quarto-content").appendChild(script);
  }
  loadGiscus();
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>¬© 2023-2025 Spatial Geography</p>
</div>   
    <div class="nav-footer-center">
      <ul class="footer-items list-unstyled">
    <li class="nav-item">
    <a class="nav-link" href="../../coc.html">
<p>Code of conduct</p>
</a>
  </li>  
    <li class="nav-item">
    <a class="nav-link" href="../../accessibility.html">
<p>Accessibility</p>
</a>
  </li>  
    <li class="nav-item">
    <a class="nav-link" href="../../license.html">
<p>License</p>
</a>
  </li>  
</ul>
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/jadeynryan/jadey_website/blob/main/blog/2024-01-22_package-review/index.qmd" class="toc-action"><i class="bi bi-github"></i>View source</a></li><li><a href="https://github.com/jadeynryan/jadey_website/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div><div class="cookie-consent-footer"><a href="#" id="open_preferences_center">Change cookies üç™</a></div></div>
    <div class="nav-footer-right">
<p>made with Ô∏é‚ô•Ô∏è &amp; <a href="https://quarto.org">Quarto</a></p>
</div>
  </div>
</footer>




<script src="../../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>